<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>WhatsApp 网页版批量加好友工具</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-shadow {
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.02);
            }
            .input-focus {
                @apply focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all duration-300;
            }
            .btn-effect {
                @apply transform hover:-translate-y-0.5 active:translate-y-0 transition-all duration-300;
            }
            .img-float {
                animation: float 3s ease-in-out infinite;
            }
            @keyframes float {
                0% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
                100% { transform: translateY(0px); }
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#25D366',
                        primaryDark: '#1EBE5B',
                        secondary: '#f0fdf4',
                        neutral: '#f8fafc',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen font-sans">
    <div class="container mx-auto px-4 py-8 max-w-2xl">
        <!-- 顶部装饰 -->
        <div class="w-24 h-1 bg-primary mx-auto mb-8 rounded-full"></div>
        
        <div class="bg-white rounded-2xl card-shadow overflow-hidden transition-all duration-500 hover:shadow-lg">
            <div class="bg-gradient-to-r from-primary to-primaryDark p-6 text-white text-center relative overflow-hidden">
                <!-- 装饰元素 -->
                <div class="absolute top-0 left-0 w-full h-full opacity-10">
                    <div class="absolute -top-6 -left-6 w-24 h-24 rounded-full bg-white"></div>
                    <div class="absolute top-32 right-8 w-16 h-16 rounded-full bg-white"></div>
                    <div class="absolute bottom-10 left-1/4 w-12 h-12 rounded-full bg-white"></div>
                </div>
                
                <div class="relative z-10">
                    <!-- 添加WhatsApp PNG图片 -->
                    <div class="mb-3 flex justify-center">
                        <img src="https://picsum.photos/seed/whatsapp/80/80" alt="WhatsApp logo" class="w-16 h-16 object-contain img-float">
                    </div>
                    <h2 class="text-2xl md:text-3xl font-bold flex items-center justify-center">
                        <i class="fa fa-whatsapp mr-3 text-xl"></i>
                        WhatsApp 网页版批量加好友工具
                    </h2>
                </div>
            </div>
            
            <div class="p-6 md:p-8">
                <!-- 进度指示器 -->
                <div class="mb-8 bg-secondary rounded-xl p-4">
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-600 flex items-center">
                            <i class="fa fa-clock-o text-primary mr-2"></i>
                            处理进度
                        </div>
                        <div class="text-sm font-medium">
                            <span id="completedCount" class="text-primary">0</span> / 
                            <span id="totalCount" class="text-gray-600">0</span>
                        </div>
                    </div>
                    <div class="mt-2 h-2 bg-gray-200 rounded-full overflow-hidden">
                        <div id="progressBar" class="h-full bg-primary rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="mb-6 transform transition-all duration-300 hover:translate-x-1">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700 flex items-center">
                        <i class="fa fa-comment text-primary mr-2"></i>
                        发送消息内容
                    </h3>
                    <textarea id="messageContent" 
                              class="w-full p-4 border border-gray-200 rounded-xl input-focus resize-none shadow-sm"
                              rows="3" 
                              placeholder="请输入要发送的消息内容">Favor contactarme</textarea>
                </div>
                
                <div class="mb-6 transform transition-all duration-300 hover:translate-x-1">
                    <h3 class="text-lg font-semibold mb-3 text-gray-700 flex items-center">
                        <i class="fa fa-phone text-primary mr-2"></i>
                        电话号码列表
                    </h3>
                    <p class="text-sm text-gray-500 mb-3 flex items-center">
                        <i class="fa fa-info-circle mr-1"></i>
                        请粘贴多行电话号码（每行1个，需含国家代码，如 +8613800138000）
                    </p>
                    <textarea id="phoneList" 
                              class="w-full p-4 border border-gray-200 rounded-xl input-focus resize-none shadow-sm"
                              rows="6" 
                              placeholder="示例：
+8613800138000
+12345678901
+447911123456"></textarea>
                </div>
                
                <div class="flex flex-col sm:flex-row items-center justify-between gap-4 mb-6">
                    <div class="text-sm text-gray-600 bg-neutral px-4 py-2 rounded-lg">
                        待处理号码: <span id="pendingCount" class="font-bold text-primary">0</span>
                    </div>
                    <button id="processBtn" 
                            class="bg-primary hover:bg-primaryDark text-white px-6 py-3 rounded-xl transition-all flex items-center btn-effect shadow-md hover:shadow-lg w-full sm:w-auto justify-center">
                        <i class="fa fa-paper-plane mr-2"></i> 处理下一个号码
                    </button>
                </div>
                
                <div class="bg-secondary p-4 rounded-xl text-sm text-gray-700 border border-green-100">
                    <p class="flex items-start">
                        <i class="fa fa-lightbulb-o text-primary mt-1 mr-3 text-lg"></i>
                        <span>操作说明：粘贴号码和消息内容后，按下 <kbd class="px-2 py-1 bg-gray-200 rounded text-xs mx-1 shadow-sm">Enter</kbd> 键或点击按钮，系统会自动跳转至WhatsApp网页版并打开聊天窗口。</span>
                    </p>
                </div>
            </div>
        </div>
        
        <!-- 底部图片装饰 -->
        <div class="mt-8 bg-white rounded-xl p-6 shadow-md overflow-hidden relative">
            <div class="absolute -right-10 -bottom-10 w-40 h-40 bg-primary/5 rounded-full"></div>
            <div class="flex flex-col md:flex-row items-center gap-6 relative z-10">
                <img src="https://picsum.photos/seed/whatsapp2/120/120" alt="WhatsApp使用示意图" class="w-24 h-24 object-cover rounded-lg shadow-md">
                <div>
                    <p class="text-sm text-gray-500 flex items-center">
                        <i class="fa fa-shield mr-2 text-primary"></i>
                        注意：使用前请确保已在浏览器中登录WhatsApp网页版（web.whatsapp.com）
                    </p>
                    <p class="text-xs text-gray-400 mt-2">工具仅用于辅助操作，请勿发送垃圾信息，遵守平台使用规则</p>
                </div>
            </div>
        </div>
        
        <!-- 页脚 -->
        <footer class="mt-12 text-center text-gray-400 text-xs">
            <p>© 2023 WhatsApp 批量加好友工具 | 仅用于辅助操作，遵守平台规则</p>
        </footer>
    </div>

    <script>
        // 获取DOM元素
        const phoneListElem = document.getElementById('phoneList');
        const messageContentElem = document.getElementById('messageContent');
        const pendingCountElem = document.getElementById('pendingCount');
        const completedCountElem = document.getElementById('completedCount');
        const totalCountElem = document.getElementById('totalCount');
        const progressBar = document.getElementById('progressBar');
        const processBtn = document.getElementById('processBtn');
        
        // 存储处理历史
        let completedCount = 0;
        let totalCount = 0;

        // 实时更新待处理号码数量
        function updateCount() {
            const phones = getPhoneList();
            const pendingCount = phones.length;
            pendingCountElem.textContent = pendingCount;
            
            // 计算总数（已完成 + 待处理）
            totalCount = completedCount + pendingCount;
            totalCountElem.textContent = totalCount;
            
            // 更新进度条
            const progress = totalCount > 0 ? (completedCount / totalCount) * 100 : 0;
            progressBar.style.width = `${progress}%`;
        }

        // 获取有效的电话号码列表
        function getPhoneList() {
            return phoneListElem.value
                .split('\n')
                .map(phone => phone.trim())
                .filter(phone => phone !== '');
        }

        // 处理下一个号码 - 跳转到WhatsApp网页版
        function processNextNumber() {
            const phones = getPhoneList();
            const message = messageContentElem.value.trim();

            if (phones.length === 0) {
                // 显示更友好的提示
                const alertDiv = document.createElement('div');
                alertDiv.className = 'fixed top-4 right-4 bg-red-500 text-white px-4 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-500 translate-x-full';
                alertDiv.innerHTML = '<i class="fa fa-exclamation-circle mr-2"></i> 请先粘贴至少1个电话号码！';
                document.body.appendChild(alertDiv);
                
                // 显示动画
                setTimeout(() => alertDiv.classList.remove('translate-x-full'), 100);
                
                // 3秒后隐藏
                setTimeout(() => {
                    alertDiv.classList.add('translate-x-full');
                    setTimeout(() => alertDiv.remove(), 500);
                }, 3000);
                
                return;
            }

            // 1. 提取首个号码和消息内容
            const firstPhone = phones[0].replace(/^\+/, ''); // 移除可能的+号，网页版链接不需要
            const encodedMessage = encodeURIComponent(message);
            
            // 2. 生成WhatsApp网页版链接
            const whatsappUrl = `https://web.whatsapp.com/send?phone=${firstPhone}&text=${encodedMessage}`;

            // 3. 新窗口打开链接
            window.open(whatsappUrl, '_blank');

            // 4. 删除首个号码，更新输入框内容
            const remainingPhones = phones.slice(1);
            phoneListElem.value = remainingPhones.join('\n');
            
            // 5. 更新已完成计数
            completedCount++;

            // 6. 更新计数和进度
            updateCount();
            
            // 添加成功提示动画
            processBtn.classList.add('bg-green-700');
            setTimeout(() => processBtn.classList.remove('bg-green-700'), 300);
        }

        // 事件监听
        phoneListElem.addEventListener('input', updateCount);
        messageContentElem.addEventListener('input', () => {});
        
        // 按钮点击处理
        processBtn.addEventListener('click', processNextNumber);
        
        // 监听Enter键
        phoneListElem.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                processNextNumber();
            }
        });

        // 初始加载时更新计数
        updateCount();
        
        // 页面加载动画
        document.addEventListener('DOMContentLoaded', () => {
            document.body.classList.add('opacity-0');
            setTimeout(() => {
                document.body.classList.remove('opacity-0');
                document.body.classList.add('transition-opacity', 'duration-1000', 'opacity-100');
            }, 100);
        });
    </script>
</body>
</html>
